as.data.frame() %>%
dcast(formula=word~year, value.var="n") %>%
column_to_rownames("word") %>%
replace(is.na(.), 0)
pca <- prcomp(df, scale. = TRUE)
pca_df <- pca$x %>% as.data.frame() %>% rownames_to_column("word")
pca_sent <- left_join(pca_df, sent, by="word")
ggplot(pca_sent) +
geom_point(aes(x=PC1, y=PC2, color=sentiment)) +
theme_classic()
report_words_clean %>% count(word)
pca_sent <- left_join(pca_sent, report_words_clean %>% count(word), by="word")
pca_sent %>% head()
ggplot(pca_sent) +
geom_point(aes(x=PC1, y=PC2, color=sentiment, size=n)) +
theme_classic()
sent <- get_sentiments("bing")
df <- report_words_clean %>%
subset(word %in% sent$word) %>%
group_by(year, word) %>%
count() %>%
as.data.frame() %>%
dcast(formula=word~year, value.var="n") %>%
column_to_rownames("word") %>%
replace(is.na(.), 0)
pca <- prcomp(df, scale. = TRUE)
pca_df <- pca$x %>% as.data.frame() %>% rownames_to_column("word")
# Add additional metadata
pca_sent <- left_join(pca_df, sent, by="word")
pca_sent <- left_join(pca_sent, report_words_clean %>% count(word), by="word")
ggplot(pca_sent) +
geom_point(aes(x=PC1, y=PC2, color=sentiment, size=n)) +
theme_classic()
ggplot(pca_sent, aes(x=PC1, y=PC2, color=sentiment, size=n)) +
geom_point() +
theme_classic()
ggplot(pca_sent, aes(
x=PC1,
y=PC2,
color=sentiment,
size=n,
label=word)) +
geom_point() +
theme_classic()
ggplot(pca_sent, aes(
x=PC1,
y=PC2,
color=sentiment,
size=n,
label=word)) +
geom_point() +
geom_text() +
theme_void()
ggplot(pca_sent,
aes(x=PC1, y=PC2, color=sentiment,
size=n, label=word)) +
geom_point() +
geom_text(check_overlap = TRUE) +
theme_void()
ggplot(pca_sent,
aes(x=PC1, y=PC2, color=sentiment,
size=n, label=word)) +
geom_point() +
geom_text(check_overlap = TRUE, hjust = 0, nudge_x = 0.05) +
theme_void()
ggplot(pca_sent,
aes(x=PC1, y=PC2, color=sentiment,
size=n, label=word)) +
geom_point() +
geom_text(check_overlap = TRUE, hjust = 0, nudge_x = 0.5) +
theme_void()
ggplot(pca_sent,
aes(x=PC1, y=PC2, color=sentiment,
size=n, label=word)) +
geom_point() +
geom_text(check_overlap = TRUE, hjust = 0, nudge_x = 1) +
theme_void()
ggplot(pca_sent,
aes(x=PC1, y=PC2, color=sentiment,
size=n, label=word)) +
geom_point() +
geom_text(check_overlap = TRUE, hjust = 0, nudge_x = 1.5) +
theme_void()
ggplot(pca_sent,
aes(x=PC1, y=PC2, color=sentiment,
size=n, label=word)) +
scale_color_manual(c("negative"="red", "positive"="green")) +
geom_point() +
geom_text(check_overlap = TRUE, hjust = 0, nudge_x = 1.5) +
theme_void()
?scale_color_manual
ggplot(pca_sent,
aes(x=PC1, y=PC2, color=sentiment,
size=n, label=word)) +
scale_color_manual(values = c("negative"="red", "positive"="green")) +
geom_point() +
geom_text(check_overlap = TRUE, hjust = 0, nudge_x = 1.5) +
theme_void()
ggplot(pca_sent,
aes(x=PC1, y=PC2, color=sentiment,
size=n, label=word)) +
scale_color_manual(values = c("negative"="red", "positive"="forestgreen")) +
geom_point() +
geom_text(check_overlap = TRUE, hjust = 0, nudge_x = 1.5) +
theme_void()
ggplot(pca_sent,
aes(x=PC1, y=PC2, color=sentiment,
size=n, label=word)) +
scale_color_manual(values = c("negative"="red", "positive"="forestgreen")) +
geom_point() +
geom_text(check_overlap = TRUE, hjust = 0, nudge_x = 1.5) +
theme_void() +
theme(legend.position="bottom")
ggplot(pca_sent,
aes(x=PC1, y=PC2, color=sentiment,
size=n, label=word)) +
scale_color_manual(values = c("negative"="red", "positive"="forestgreen")) +
geom_point() +
geom_text(check_overlap = TRUE, hjust = 0, nudge_x = 1.5) +
theme_void() +
theme(legend.position="bottom") +
labs(x="PC1", y="PC2")
ggplot(pca_sent,
aes(x=PC1, y=PC2, color=sentiment,
size=n, label=word)) +
scale_color_manual(values = c("negative"="red", "positive"="forestgreen")) +
geom_point() +
geom_text() +
theme_void() +
theme(legend.position="bottom") +
labs(x="PC1", y="PC2")
ggplot(pca_sent,
aes(x=PC1, y=PC2, color=sentiment,
size=n, label=word)) +
scale_color_manual(values = c("negative"="red", "positive"="forestgreen")) +
geom_point() +
geom_text_repel() +
theme_void() +
theme(legend.position="bottom") +
labs(x="PC1", y="PC2")
library(ggrepel)
ggplot(pca_sent,
aes(x=PC1, y=PC2, color=sentiment,
size=n, label=word)) +
scale_color_manual(values = c("negative"="red", "positive"="forestgreen")) +
geom_point() +
geom_text_repel() +
theme_void() +
theme(legend.position="bottom") +
labs(x="PC1", y="PC2")
n_words <- report_words_clean %>% count(word)
n_words
report_words_keep <- n_words %>% subset(n > 5)
report_words_keep
source("~/Documents/personal_github/tidy_tuesday/plots/2025/2025-03-25/amazon_text.R", echo=TRUE)
source("~/Documents/personal_github/tidy_tuesday/plots/2025/2025-03-25/amazon_text.R", echo=TRUE)
source("~/Documents/personal_github/tidy_tuesday/plots/2025/2025-03-25/amazon_text.R", echo=TRUE)
source("~/Documents/personal_github/tidy_tuesday/plots/2025/2025-03-25/amazon_text.R", echo=TRUE)
source("~/Documents/personal_github/tidy_tuesday/plots/2025/2025-03-25/amazon_text.R", echo=TRUE)
source("~/Documents/personal_github/tidy_tuesday/plots/2025/2025-03-25/amazon_text.R", echo=TRUE)
source("~/Documents/personal_github/tidy_tuesday/plots/2025/2025-03-25/amazon_text.R", echo=TRUE)
BiocManager::install("speckle")
# Load libraries
library(tidyverse)
library(tidytuesdayR)
library(ggplot2)
library(reshape2)
library(ggrepel)
# Load dataset
tuesdata <- tidytuesdayR::tt_load(2025, week = 12)
report_words_clean <- tuesdata$report_words_clean
# Use tidytext package for sentiment analysis
library(tidytext)
sent <- get_sentiments("bing")
sent <- get_sentiments("bing")
df <- report_words_clean %>%
subset(word %in% sent$word) %>%
group_by(year, word) %>%
count() %>%
as.data.frame() %>%
dcast(formula=word~year, value.var="n") %>%
column_to_rownames("word") %>%
replace(is.na(.), 0)
df %>% head()
df <- report_words_clean %>%
left_join(sent) %>%
head()
df
df <- report_words_clean %>%
left_join(sent) %>%
subset(!is.na(sentiment))
df %>% head()
sent$sentiment %>% unique()
df <- report_words_clean %>%
left_join(sent) %>%
subset(!is.na(sentiment)) %>%
group_by(year) %>%
count(sentiment)
df %>% head()
df %>% ggplot(aes(x=sentiment, y=n, fill=sentiment)) +
geom_bar(stat = "identity", position = "stack", width = 0.7)
df %>% ggplot(aes(x=sentiment, y=n, fill=sentiment)) +
geom_bar(stat = "identity", position = "stack", width = 0.7) +
oord_polar(theta = "y", direction = -1, clip = "off")
df %>% ggplot(aes(x=sentiment, y=n, fill=sentiment)) +
geom_bar(stat = "identity", position = "stack", width = 0.7) +
coord_polar(theta = "y", direction = -1, clip = "off")
df %>% ggplot(aes(x=sentiment, y=n, fill=sentiment)) +
geom_bar(stat = "identity", position = "stack", width = 0.7) +
coord_polar(theta = "y", direction = -1, clip = "off") +
facet_wrap(~year)
df %>% head()
df <- report_words_clean %>%
left_join(sent) %>%
subset(!is.na(sentiment)) %>%
group_by(year) %>%
summarise(n = n()) %>%
mutate(freq = n / sum(n))
df %>% head()
df %>% ggplot(aes(x=sentiment, y=n, fill=sentiment)) +
geom_bar(stat = "identity", position = "stack", width = 0.7) +
coord_polar(theta = "y", direction = -1, clip = "off") +
facet_wrap(~year)
df <- report_words_clean %>%
left_join(sent) %>%
subset(!is.na(sentiment)) %>%
group_by(year) %>%
summarise(n = n(sentiment)) %>%
mutate(freq = n / sum(n))
report_words_clean %>%
left_join(sent) %>%
subset(!is.na(sentiment)) %>%
group_by(year) %>%
summarise(n = ()) %>% head()
report_words_clean %>%
left_join(sent) %>%
subset(!is.na(sentiment)) %>%
group_by(year) %>%
summarise(n = n()) %>% head()
report_words_clean %>%
left_join(sent) %>%
subset(!is.na(sentiment)) %>%
group_by(year, sentiment) %>%
summarise(n = n()) %>% head()
report_words_clean %>%
left_join(sent) %>%
subset(!is.na(sentiment)) %>%
group_by(year, sentiment) %>%
summarise(n = n()) %>%
mutate(freq = n / sum(n))
df <- report_words_clean %>%
left_join(sent) %>%
subset(!is.na(sentiment)) %>%
group_by(year, sentiment) %>%
summarise(n = n()) %>%
mutate(freq = n / sum(n))
df %>% ggplot(aes(x=sentiment, y=n, fill=sentiment)) +
geom_bar(stat = "identity", position = "stack", width = 0.7) +
coord_polar(theta = "y", direction = -1, clip = "off") +
facet_wrap(~year)
df <- report_words_clean %>%
left_join(sent) %>%
subset(!is.na(sentiment)) %>%
group_by(year, sentiment) %>%
summarise(n = n()) %>%
mutate(freq = n / sum(n))
df
df %>% ggplot(aes(x=sentiment, y=freq, fill=sentiment)) +
geom_bar(stat = "identity", position = "stack", width = 0.7) +
coord_polar(theta = "y", direction = -1, clip = "off") +
facet_wrap(~year)
df %>% ggplot(aes(x=sentiment, y=freq, fill=sentiment)) +
geom_bar(stat = "identity", position = "stack", width = 0.7) +
coord_polar(theta = "y", direction = -1, clip = "off") +
facet_wrap(~year) +
theme_void()
df %>% ggplot(aes(x="x", y=freq, fill=sentiment)) +
geom_bar(stat = "identity", position = "stack", width = 0.7) +
coord_polar(theta = "y", direction = -1, clip = "off") +
facet_wrap(~year) +
theme_void()
sent <- get_sentiments("nrc")
df <- report_words_clean %>%
left_join(sent) %>%
subset(!is.na(sentiment)) %>%
group_by(year, sentiment) %>%
summarise(n = n()) %>%
mutate(freq = n / sum(n))
df %>% ggplot(aes(x="x", y=freq, fill=sentiment)) +
geom_bar(stat = "identity", position = "stack", width = 0.7) +
coord_polar(theta = "y", direction = -1, clip = "off") +
facet_wrap(~year) +
theme_void()
df %>% ggplot(aes(x="x", y=freq, fill=sentiment)) +
geom_bar(stat = "identity", position = "stack", width = 0.7, color="black") +
coord_polar(theta = "y", direction = -1, clip = "off") +
facet_wrap(~year) +
theme_void()
# sent <- get_sentiments("nrc")
sent <- get_sentiments("bing")
df <- report_words_clean %>%
left_join(sent) %>%
subset(!is.na(sentiment)) %>%
group_by(year, sentiment) %>%
summarise(n = n()) %>%
mutate(freq = n / sum(n))
df %>% ggplot(aes(x="x", y=freq, fill=sentiment)) +
geom_bar(stat = "identity", position = "stack", width = 0.7, color="black") +
coord_polar(theta = "y", direction = -1, clip = "off") +
facet_wrap(~year) +
theme_void()
# sent <- get_sentiments("nrc")
# sent <- get_sentiments("afinn")
sent <- get_sentiments("bing")
# sent <- get_sentiments("nrc")
sent <- get_sentiments("afinn")
df <- report_words_clean %>%
left_join(sent) %>%
subset(!is.na(sentiment)) %>%
group_by(year, sentiment) %>%
summarise(n = n()) %>%
mutate(freq = n / sum(n))
df %>% ggplot(aes(x="x", y=freq, fill=sentiment)) +
geom_bar(stat = "identity", position = "stack", width = 0.7, color="black") +
coord_polar(theta = "y", direction = -1, clip = "off") +
facet_wrap(~year) +
theme_void()
sent %>% head()
# sent <- get_sentiments("nrc")
# sent <- get_sentiments("afinn")
sent <- get_sentiments("bing")
df <- report_words_clean %>%
left_join(sent) %>%
subset(!is.na(sentiment)) %>%
group_by(year, sentiment) %>%
summarise(n = n()) %>%
mutate(freq = n / sum(n))
df %>% ggplot(aes(x="x", y=freq, fill=sentiment)) +
geom_bar(stat = "identity", position = "stack", width = 0.7, color="black") +
coord_polar(theta = "y", direction = -1, clip = "off") +
facet_wrap(~year) +
theme_void()
df %>% ggplot(aes(x="x", y=freq, fill=sentiment)) +
geom_bar(stat = "identity", position = "stack", width = 0.7, color="black") +
coord_polar(theta = "y", direction = -1, clip = "off") +
facet_wrap(~year) +
scale_fill_manual(c("negative"="red", "positive"="forestgreen"))
df %>% ggplot(aes(x="x", y=freq, fill=sentiment)) +
geom_bar(stat = "identity", position = "stack", width = 0.7, color="black") +
coord_polar(theta = "y", direction = -1, clip = "off") +
facet_wrap(~year) +
scale_fill_manual(values=c("negative"="red", "positive"="forestgreen"))
df %>% ggplot(aes(x="x", y=freq, fill=sentiment)) +
geom_bar(stat = "identity", position = "stack", width = 0.7, color="black") +
coord_polar(theta = "y", direction = -1, clip = "off") +
facet_wrap(~year) +
scale_fill_manual(values=c("negative"="red", "positive"="forestgreen")) +
theme_void()
df %>% ggplot(aes(x="x", y=freq, fill=sentiment)) +
geom_bar(stat = "identity", position = "stack", width = 0.7, color="black") +
coord_polar(theta = "y", direction = -1, clip = "off") +
facet_wrap(~year) +
scale_fill_manual(values=c("negative"="red", "positive"="forestgreen")) +
theme_void() +
NoLegend()
df %>% ggplot(aes(x="x", y=freq, fill=sentiment)) +
geom_bar(stat = "identity", position = "stack", width = 0.7, color="black") +
coord_polar(theta = "y", direction = -1, clip = "off") +
facet_wrap(~year) +
scale_fill_manual(values=c("negative"="red", "positive"="forestgreen")) +
theme_void() +
theme(legend.position="none")
df %>% ggplot(aes(x="x", y=freq, fill=sentiment)) +
geom_bar(stat = "identity", position = "stack", width = 0.7, color="black") +
scale_x_discrete(limits = c("x_empty", "x")) +
coord_polar(theta = "y", direction = -1, clip = "off") +
facet_wrap(~year) +
scale_fill_manual(values=c("negative"="red", "positive"="forestgreen")) +
theme_void() +
theme(legend.position="none")
df %>% ggplot(aes(x="x", y=freq, fill=sentiment)) +
geom_bar(stat = "identity", position = "stack", width = 0.7, color="black") +
scale_x_discrete(limits = c("x_empty", "x")) +
coord_polar(theta = "y", direction = -1, clip = "off") +
facet_wrap(~year) +
scale_fill_manual(values=c("negative"="red", "positive"="forestgreen")) +
theme_void() +
theme(legend.position="none") +
theme(plot.title = element_text(vjust=2))
df %>% ggplot(aes(x="x", y=freq, fill=sentiment)) +
geom_bar(stat = "identity", position = "stack", width = 0.7, color="black") +
scale_x_discrete(limits = c("x_empty", "x")) +
coord_polar(theta = "y", direction = -1, clip = "off") +
facet_wrap(~year) +
scale_fill_manual(values=c("negative"="red", "positive"="forestgreen")) +
theme_void() +
theme(legend.position="none") +
theme(plot.title = element_text(vjust=rel(0.5)))
df %>% ggplot(aes(x="x", y=freq, fill=sentiment)) +
geom_bar(stat = "identity", position = "stack", width = 0.7, color="black") +
scale_x_discrete(limits = c("x_empty", "x")) +
coord_polar(theta = "y", direction = -1, clip = "off") +
facet_wrap(~year) +
scale_fill_manual(values=c("negative"="red", "positive"="forestgreen")) +
theme_void() +
theme(legend.position="none") +
theme(plot.title = element_text(vjust=rel(-0.5)))
source("~/Documents/personal_github/tidy_tuesday/plots/2025/2025-03-25/amazon_text.R", echo=TRUE)
df %>% ggplot(aes(x="x", y=freq, fill=sentiment)) +
geom_bar(stat = "identity", position = "stack", width = 0.7, color="black") +
scale_x_discrete(limits = c("x_empty", "x")) +
coord_polar(theta = "y", direction = -1, clip = "off") +
facet_wrap(~year) +
scale_fill_manual(values=c("negative"="red", "positive"="forestgreen")) +
theme_void() +
theme(legend.position="none") +
theme(plot.title = element_text(vjust=rel(-100)))
df %>% ggplot(aes(x="x", y=freq, fill=sentiment)) +
geom_bar(stat = "identity", position = "stack", width = 0.7, color="black") +
scale_x_discrete(limits = c("x_empty", "x")) +
coord_polar(theta = "y", direction = -1, clip = "off") +
scale_fill_manual(values=c("negative"="red", "positive"="forestgreen")) +
theme_void() +
theme(legend.position="none") +
theme(plot.title = element_text(vjust=rel(-100))) +
facet_wrap(~year)
df
df$freq
sent <- get_sentiments("nrc")
df <- report_words_clean %>%
left_join(sent) %>%
subset(!is.na(sentiment)) %>%
group_by(year, sentiment) %>%
summarise(n = n()) %>%
mutate(freq = n / sum(n))
df %>% ggplot(aes(x="x", y=freq, fill=sentiment)) +
geom_bar(stat = "identity", position = "stack", width = 0.7, color="black") +
scale_x_discrete(limits = c("x_empty", "x")) +
coord_polar(theta = "y", direction = -1, clip = "off") +
scale_fill_manual(values=c("negative"="red", "positive"="forestgreen")) +
theme_void() +
theme(plot.title = element_text(vjust=rel(-100))) +
facet_wrap(~year)
sent %>% head()
sent <- get_sentiments("nrc")
df <- report_words_clean %>%
left_join(sent) %>%
subset(!is.na(sentiment)) %>%
group_by(year, sentiment) %>%
summarise(n = n()) %>%
mutate(freq = n / sum(n))
df %>% head()
df %>% ggplot(aes(x="x", y=freq, fill=sentiment)) +
geom_bar(stat = "identity", position = "stack", width = 0.7, color="black") +
scale_x_discrete(limits = c("x_empty", "x")) +
coord_polar(theta = "y", direction = -1, clip = "off") +
scale_fill_manual(values=c("negative"="red", "positive"="forestgreen")) +
theme_void() +
theme(plot.title = element_text(vjust=rel(-100))) +
facet_wrap(~year)
df <- report_words_clean %>%
left_join(sent) %>%
subset(!is.na(sentiment)) %>%
group_by(year, sentiment) %>%
summarise(n = n()) %>%
mutate(freq = n / sum(n))
df
df %>% tail()
df
df <- report_words_clean %>%
left_join(sent) %>%
subset(!is.na(sentiment)) %>%
group_by(year, sentiment) %>%
mutate(freq = n / sum(n))
df %>% head()
df
df %>% ggplot(aes(x="x", y=freq, fill=sentiment)) +
geom_bar(stat = "identity", position = "stack", width = 0.7, color="black") +
scale_x_discrete(limits = c("x_empty", "x")) +
coord_polar(theta = "y", direction = -1, clip = "off") +
scale_fill_manual(values=c("negative"="red", "positive"="forestgreen")) +
theme_void() +
theme(plot.title = element_text(vjust=rel(-100))) +
facet_wrap(~year)
df <- report_words_clean %>%
left_join(sent) %>%
subset(!is.na(sentiment)) %>%
group_by(year, sentiment) %>%
count(year, sentimet) %>%
mutate(freq = n / sum(n))
df
df %>% ggplot(aes(x="x", y=freq, fill=sentiment)) +
geom_bar(stat = "identity", position = "stack", width = 0.7, color="black") +
scale_x_discrete(limits = c("x_empty", "x")) +
coord_polar(theta = "y", direction = -1, clip = "off") +
theme_void() +
theme(plot.title = element_text(vjust=rel(-100))) +
facet_wrap(~year)
df %>% ggplot(aes(x="x", y=freq, fill=sentiment)) +
geom_bar(stat = "identity", position = "stack", width = 0.7, color="black") +
scale_x_discrete(limits = c("x_empty", "x")) +
coord_polar(theta = "y", direction = -1, clip = "off") +
theme_void() +
theme(plot.title = element_text(vjust = 10)) +
facet_wrap(~year)
df %>% ggplot(aes(x="x", y=freq, fill=sentiment)) +
geom_bar(stat = "identity", position = "stack", width = 0.7, color="black") +
scale_x_discrete(limits = c("x_empty", "x")) +
coord_polar(theta = "y", direction = -1, clip = "off") +
theme_void() +
theme(plot.title = element_text(vjust = 0.5)) +
facet_wrap(~year)
